[01]上线流程规范

C-3创建:侯现佑(离职), 最后修改: 陈志阁2017-04-18 17:37
目录
上线时间要求
标准开发流程
《上线申请单》
《重大项目上线Checklist》
注： 如果是紧急修复线上bug，可以不遵守上线流程，但一定要提前告知Leader，通过后可以直接上线。

上线时间要求
      提交上线申请时间：  周一 ~ 周四     10:00~12:00

      线上更新时间：         周一 ~ 周四     14:00~17:00;  20:00~22:00 

标准开发流程
项目评估与开发（重大项目需要准备 《重点项目上线Checklist》，包括上线预案、回滚预案([02]回滚方案)、重点监测项、负责人）

RD自测（测试本次修改模块及有影响模块）

本地sonar代码检查，确保没有block，对critical数量严格控制

Code Review（普通开发至少1人Review，重大项目3人Review，且重大项目修改需要增加上线前Review）

压力测试

PM验收

QA测试

自动化测试

安全扫描

提交《重大项目提交上线》（wiki备注+大象周知）

提交《上线申请单》（详细步骤见 研发上线流程，wiki备注+大象周知）

本地sonar代码检查，确保没有block，对critical数量严格控制； 如果代码没有问题可以合并master

stage部署 & 大象周知 & 测试，  例： 部署xxx服务备机

线上 部署 & 大象周知 & 测试 ，  
例：(上线提醒时)【上线申请】banma_admin上线 修复异常订单等上传时100条限制_15:30_程龙、杨耀宗  http://wiki.sankuai.com/pages/viewpage.action?pageId=368980368
例：(实际操作时)  banma_admin上线，上线版本：xxxx，回滚版本：xxxxxx

RD回复 上线5min后，检查服务各项指标是否正常
例：(上线完成后)  banma_admin上线完成，服务log-error、cpu、mem、load、socket连接数检查正常 ---- 检查服务各项指标

    注：

    执行标准：红色为必须执行，蓝色由Leader评估是否执行，黑色为有条件后执行

    重大项目标准：各组Leader评估风险决定 || 涉及跨部门协作更新 || 涉及数据库/缓存/消息队列/重要log的数据结构改动

    Code Review检查关键项：详见Code规范



1.我们经常说的Prod、Staging、Dev、QA环境的区别是什么？一个完整业务开发各分支合并的流程是什么？

 Prod：生产环境

Staging：备机，与生产环境的区别仅仅是没有引入流量

Dev：开发环境

QA：测试环境

流程：

a.和QA和其他2位开发同学一起review设计方案

b.基于master主干创建自己的分支,开发

c.将自己的分支合并到develop分支，发布dev环境，调试

d.代码review

e.将代码合并到qa分支，提交给qa测试（要提前自己跑完测试用例）

f.合并代码至master

g.发布staging环境，qa验证

h.灰度发布一台机器，引流压测

i.全量发布上线

