### java类生命周期

java类的加载过程

#### 读取加载

**读取class文件**

由类加载器读取class文件，将class文件的二进制数据放入运行时内存的方法区，并创建对应的Class对象，将对象放在堆内存，Class对象封装类在方法区的数据结构

jvm会对class进行预加载，即使进程并没有主动使用该类，jvm也会根据情况进行预加载，预加载时如果出错会等到主动使用时才报错，如果这个类没有程序主动使用则永远不会报错

#### 连接

**验证class文件**

主要验证class文件内容格式是否符合Class文件的格式规范；验证Class内容是否符合java语法/语义等等

**准备**

jvm为类变量初始化内存，并设置默认的初始值

**解析：符号替换**

比如函数调用，转换为指针调用

#### 初始化

**初始化时机**

* 创建类的实例。包括new关键字来创建，或者通过反射、克隆及反序列化方式来创建实例。
* 调用类的静态方法。
* 访问某个类或接口的静态变量，或者对该静态变量赋值。
* 使用反射机制来创建某个类或接口对应的java.lang.Class对象。例如Class.forName("Test")操作，如果系统还未初始化Test类，这波操作会导致该Test类被初始化，并返回Test类对应的java.lang.Class对象。
* 初始化一个类的子类，该子类所有的父类都会被初始化。
* JVM启动时被标明为启动类的类（直接使用java.exe命令运行某个主类）。例如对于“java Test”命令，Test类就是启动类（主类），JVM会先初始化这个主类。

**初始化过程**

当JVM初始化一个类时，要求它的所有父类都已经初始化完毕，但是这条规则并不适用于接口。

在初始化一个类时，并不会先初始化它所实现的接口。

在初始化一个接口时，并不会先初始化它的父接口。


